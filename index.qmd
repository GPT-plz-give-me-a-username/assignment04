---
title: "Data Science for Public Policy"
subtitle: "Assignment 04"
author: "Ruiyang Zhang - rz326; Xiangming Zeng - xz634; Xiaorui Shi - xs215"
execute:
  warning: false
format:
  html:
    embed-resources: true
---

## Source of Data
Quality of Government Basic Dataset (2023)

## Libraries

```{r}
library(tidyverse)
library(haven)
```

## Data preparation

```{r}
qog <- read_dta("data/idm_qog.dta")
qog <- qog %>% 
  select(year, 
         country_name = cname, 
         gdp_per_capita = gle_cgdpc, 
         democracy = chga_demo, 
         transparency_index = diat_ti, 
         new_busi_density = wdi_busden,
         level_of_democracy = ht_ipolity2
         ) 
```

### Exercise 03

The message says "The following paths are ignored by one of your .gitignore files: data"

### Exercise 04: Data visualization

## Why democracies have better economic performance? One explanation
**The Story:** The distribution of wealth is extremely unequal. Most countries are poor, while few are rich. However, democracies exhibit significantly higher economic performance than autocracies. What is the mechanism behind this difference? This study proposes one possible explanation: democracies feature high information transparency, which can reduce corruption and improve the business environment. Consequently, enterprises find it easier to emerge and grow in democracies compared to autocracies.

### The global distribution of GDP per Capita
```{r}
qog %>% 
  filter(year==2008) %>% 
  ggplot(aes(gdp_per_capita)) +
  geom_histogram(bins = 80,fill="deepskyblue3",alpha=0.7)+
  labs(
    title = "Distribution of countries' GDP per capita",
    subtitle = "US Dollar($)",
    y = "Frequency",
    x = "GDP per capita",
    caption = "Source: The Quality of Government Basic Dataset (2023)"
  )

```


### The difference of GDP per Capita between two political systems
```{r}
qog %>% 
  filter(year==2008) %>% 
  mutate(chrdemo = case_when(
    democracy==0 ~ "Dictatorship",
    democracy==1 ~ "Democracy")) %>%
  filter(chrdemo!=is.na(chrdemo)) %>% 
  ggplot(aes(chrdemo,gdp_per_capita))+
  geom_boxplot(aes(fill=chrdemo))+
  theme_minimal()+
  scale_fill_manual(values = c( "#CCEDB1", "#41B7C4"))+
  labs(
    title = "GDP per capita by regime types",
    subtitle = "US Dollar($)",
    y = "GDP per capita",
    caption = "Source: The Quality of Government Basic Dataset (2023)"
  )

```

```{r}
qog %>%
  filter(year==2008) %>% 
  ggplot(aes(x=level_of_democracy)) +
  geom_line(aes(y=transparency_index),color="#41B7C4") +
  scale_y_continuous(limits = c(0,100))+
  theme_minimal()+
  labs(
  title = "Transparency and Level of Democracy",
       subtitle = "Democracies on average have higher level of transparency",
       x = "Level of Democracy",
       y = NULL,
       caption = "Source: The Quality of Government Basic Dataset (2023)")
```


### The relationship between transparency and entrepreneurship
```{r}
qog %>% ggplot(aes(x = transparency_index, y = new_busi_density))+
  geom_point(aes(color = level_of_democracy, size = gdp_per_capita),
             ) +
  geom_smooth(method = "lm") +
  scale_y_log10() +
  xlab("Transparency index") +
  ylab("New business density") +
  labs(title = "The Relationship Between Transparancy and Entrepreneurship",
       subtitle = "Can information transparancy enhance business growth?",
       caption = "Data Source: The Quality of Government Basic Dataset (2023)") +
  labs(color = "Level of democracy", size = "GDP per Capita") +
  theme(
    legend.key = element_blank(),
    legend.key.size = unit(0.45, "cm")
  )

```
As shown in this graph, the transparency index has a positive linear correlation with the logarithm base 10 of new business density, which aligns with our theory. Additionally, points in the upper part of the graph are larger than points in the lower part, on average, indicating that GDP per capita has a positive correlation with new business density. Moreover, points in the southwest part of the graph are darker than points in the northeast part, which means that autocracies have both a lower transparency index and lower GDP per capita.

### Policy Relevance
Therefore, to improve the performance of the developing world and reduce the global socioeconomic inequality, one possible way is supporting the establishment of robust democratic systems among developing countries. However, for countries where autocratic systems are entrenched, one more realistic way is to leverage the influence of international organizations to increase the transparency level of those countries.
